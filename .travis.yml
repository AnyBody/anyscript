language: ruby

cache: bundler


env:
  global:
    # Doctr deploy key for melund/melund.github.io
    - secure: "qOyWIVnt0ljrbGSiJ6c3kaND2Mle5gFUw+1bOSdjU/+QX/fqmRKNCAzxAoEBQ9kzJsoKZyDGOpjC4ru71xqKqvjTSHyJmmXB307/vG18xr9UNbPYfG0WePJGsYpmrT4i73JIZYoQaIfFNBukbXswOqvILjvy/9DBRTmDzzD9dGrllEs5LrapraWuPCSrB9DfDSMHFYSnGq62bMiS7lO0X2wUvyoiMLyNNKoO+t4n+wIqulbEv6iy0nOdb+XTNnT7S18HtcscMZiHu7y4AYsG0G9GU+W9NOam2mQWcWfkiUDjI77g3yjCyUzPrpz1lBI98k5HojCuxtzz5zaQYfKbg8GFM9Furd5XDoQnT24sEmVa1Yd+9yDECBCCSeFc+DF0gCTmnTBdWApN5X0JpMDebrJEu2BAh01I/xbjiWLFOVT+xCmS2uCutiuSH2H9Obr9mIb0txdMWyCCN3svj8oZfndMF+9HEl1BWJ6zR83bpNSMwy3nkGN+Z1FZqbXrTG/T5Vwi4f81uc8YlOKmPzxRsmXrV1LvSqmV8POGeF6bu79UN29B2TISeXizlUXjz9YCPhsj+FlLtjo2QUrvFwS2tXac8v4Gw6nIkJt+eJqMHFp7R+mGJ7Cbr2VAcS86JdiNthGZUGpwhIGH+kXDjq9MCx/t8h1XY4iihLVBomDWfKQ="
    - NOKOGIRI_USE_SYSTEM_LIBRARIES=true # speeds up installation of html-proofer

install:
  - gem install bundler
  - bundle install
  - wget https://repo.continuum.io/miniconda/Miniconda3-latest-Linux-x86_64.sh -O miniconda.sh;
  - bash miniconda.sh -b -p $HOME/miniconda
  - export PATH="$HOME/miniconda/bin:$PATH"
  - hash -r
  - conda config --set always_yes yes --set changeps1 no
  - conda config --add channels conda-forge # For sphinxcontrib.autoprogram
  - conda update -q conda
  - conda info -a
  - conda create -q -n doc-build-environment python=3.6 doctr pygments_anyscript
  - source activate doc-build-environment

before_script:
  - rvm get head || true

script:
  - set -e
  - bundle exec jekyll build
  #- htmlproofer ./_site
  - doctr deploy --built-docs ./_site --deploy-branch-name master --deploy-repo melund/melund.github.io .;


sudo: false # route your build to the container-based infrastructure for a faster build
